<%- include('../../partials/header.ejs') %>

<%- include('../../partials/cep.ejs') %>

<script type="text/javascript">
    $("#Celular").mask("(00) 00000-0000");
    $("#SegundoTelefone").mask("(00) 00000-0000");
    $("#dataabertura").mask("00/00/0000");
    $("#datasituacao").mask("00/00/0000");


</script>

<!-- Page Wrapper -->
<div id="wrapper">
    <!-- Sidebar -->
    <%- include ('../../partials/sidebar.ejs') %>

    <!-- End of Sidebar -->
    <!-- Content Wrapper -->
    <div id="content-wrapper" class="d-flex flex-column">
        <!-- Main Content -->
        <div id="content">
            <!-- Topbar -->
            <%- include('../../partials/topbar.ejs'); %>
            <!-- End of Topbar -->
            <!-- Begin Page Content -->
            <div class="container-fluid">
                <!-- Page Heading -->
                <!-- Local para Centralizar o conteúdo 
                <div class="container">
                -->
                <div>
                    <form method="POST" action="/admin/processos/salvarpergunta">
                        <!-- Content Row -->

                        <!-- Content Row -->
                        <div class="row">
                            <!-- Earnings (Monthly) Card Example -->
                            <div class="col-xl-12 col-md-6 mb-4">


                                <div class="card shadow mb-4">

                                    <div class="card-body">


                                        <div class="form-row">


                                            <div class="col-xl-1 col-md-6 mb-4">
                                                <small id="passwordHelpBlock" class="form-text text-muted">Data</small>
                                                <input type="text" class="form-control form-control-sm"
                                                       name="datacomparecimento" value=""></input>
                                            </div>

                                            <div class="col-xl-1 col-md-6 mb-4">
                                                <small id="passwordHelpBlock" class="form-text text-muted">CPF</small>
                                                <input class="form-control form-control-sm" name="cpf" value=""></input>
                                            </div>

                                            <div class="col-xl-4 col-md-6 mb-4">
                                                <small id="passwordHelpBlock" class="form-text text-muted">Nome do
                                                    Beneficiário</small>
                                                <input type="text" class="form-control form-control-sm"
                                                       name="nomebeneficiario" value=""></input>
                                            </div>

                                            <div class="col-xl-2 col-md-6 mb-4">
                                                <small id="passwordHelpBlock" class="form-text text-muted">Telefone
                                                    Fixo</small>
                                                <input type="text" class="form-control form-control-sm" name="telefone"
                                                       value=""></input>
                                            </div>

                                            <div class="col-xl-2 col-md-6 mb-4">
                                                <small id="passwordHelpBlock"
                                                       class="form-text text-muted">Celular</small>
                                                <input type="text" class="form-control form-control-sm" name="celular"
                                                       value=""></input>
                                            </div>

                                            <div class="col-xl-2 col-md-6 mb-4">
                                                <small id="passwordHelpBlock" class="form-text text-muted">Telefone
                                                    2</small>
                                                <input type="text" class="form-control form-control-sm" name="telefone2"
                                                       value=""></input>
                                            </div>


                                        </div>


                                        <div class="form-row">

                                            <div class="col-xl-1 col-md-6 mb-4">
                                                <small id="passwordHelpBlock" class="form-text text-muted">Cep</small>
                                                <input type="text" maxlength="9" class="form-control form-control-sm"
                                                       name="cep" id="cep" value="" size="10"
                                                       onblur="pesquisacep(this.value);"></input>
                                            </div>

                                            <div class="col-xl-3 col-md-6 mb-4">
                                                <small id="passwordHelpBlock"
                                                       class="form-text text-muted">Logradouro</small>
                                                <input style="text-transform: uppercase;" id="logradouro"
                                                       class="form-control form-control-sm" name="logradouro"
                                                       value=""></input>

                                            </div>


                                            <div class="col-xl-1 col-md-6 mb-4">
                                                <small id="passwordHelpBlock"
                                                       class="form-text text-muted">Número</small>
                                                <input id="numero" type="number" class="form-control form-control-sm"
                                                       name="numero" value=""></input>
                                            </div>

                                            <div class="col-xl-2 col-md-6 mb-4">
                                                <small id="passwordHelpBlock"
                                                       class="form-text text-muted">Complemento</small>
                                                <input style="text-transform: uppercase;" id="complemento"
                                                       class="form-control form-control-sm" name="complemento"
                                                       value=""></input>
                                            </div>


                                            <div class="col-xl-2 col-md-6 mb-4">
                                                <small id="passwordHelpBlock"
                                                       class="form-text text-muted">Bairro</small>
                                                <input style="text-transform: uppercase;" id="bairro"
                                                       class="form-control form-control-sm" name="bairro"
                                                       value=""></input>
                                            </div>

                                            <div class="col-xl-3 col-md-6 mb-4">
                                                <small id="passwordHelpBlock"
                                                       class="form-text text-muted">Cidade</small>
                                                <input style="text-transform: uppercase;" id="cidade"
                                                       class="form-control form-control-sm" name="cidade"
                                                       value=""></input>
                                            </div>


                                        </div>

                                        <div class="form-row">
                                            <div class="col-xl-2 col-md-6 mb-4">
                                                <small id="passwordHelpBlock" class="form-text text-muted">Benefício
                                                    Requerido</small>
                                                <select class="form-control form-control-sm" name="beneficiorequerido">
                                                    <option value=""></option>
                                                    <option value="LOAS IDOSO">LOAS IDOSO</option>
                                                    <option value="LOAS DEFICIENTE">LOAS DEFICIENTE</option>
                                                    <option value="LOAS NIVER">LOAS NIVER</option>
                                                    <option value="OUTROS">OUTROS</option>
                                                </select>
                                            </div>

                                            <div class="col-xl-2 col-md-6 mb-4">
                                                <small id="passwordHelpBlock"
                                                       class="form-text text-muted">Indicação</small>
                                                <select class="form-control form-control-sm" name="indicacao">
                                                    <option value="SBTIB">SBT-IB</option>
                                                    <option value="AC">ANTÔNIO CARLOS</option>
                                                    <option value="TUPI">TUPI</option>
                                                    <option value="CIDINHA">CIDINHA</option>
                                                    <option value="PA">PEDRO AUGUSTO</option>
                                                    <option value="CM">CM</option>
                                                    <option value="PANFLETO">PANFLETO</option>
                                                    <option value="AMIGOVIZINHO">AMIGO/VIZINHO</option>
                                                    <option value="HR">HR</option>
                                                    <option value="IBT">IBT</option>
                                                    <option value="GLOBO">GLOBO</option>
                                                </select>
                                            </div>

                                            <div class="col-xl-8 col-md-6 mb-4">
                                                <small id="passwordHelpBlock" class="form-text text-muted">Pendência de
                                                    Documentos</small>
                                                <input class="form-control form-control-sm" name="pendenciadedocumentos"
                                                       value=""></input>
                                            </div>

                                            <div class="col-xl-12 col-md-6 mb-4">
                                                <small id="passwordHelpBlock" class="form-text text-muted">Informação
                                                    Complementar</small>
                                                <textarea type="text"
                                                          class="p-3 mb-2 bg-light text-dark form-control form-control-sm"
                                                          name="informacaocomplementar" id="informacaocomplementar"
                                                          value="" rows="4" cols="66"></textarea>
                                            </div>

                                            <div class="col-xl-4 col-md-6 mb-4">
                                                <small id="passwordHelpBlock"
                                                       class="form-text text-muted">Enviados</small>
                                                <input class="form-control form-control-sm" name="enviados"
                                                       value=""></input>
                                            </div>

                                            <div class="col-xl-4 col-md-6 mb-4">
                                                <small id="passwordHelpBlock"
                                                       class="form-text text-muted">Entrada</small>
                                                <input class="form-control form-control-sm" name="entrada"
                                                       value=""></input>
                                            </div>


                                            <div class="col-xl-4 col-md-6 mb-4">
                                                <small id="passwordHelpBlock" class="form-text text-muted">Senha do
                                                    Cliente</small>
                                                <input class="form-control form-control-sm" name="senhadocliente"
                                                       value=""></input>
                                            </div>

                                            <div class="col-xl-2 col-md-6 mb-4">
                                                <small id="passwordHelpBlock"
                                                       class="form-text text-muted">Situação</small>
                                                <select class="form-control form-control-sm" name="situacao">
                                                    <option value=""></option>
                                                    <option value="ANALISE">ANÁLISE</option>
                                                    <option value="ANALISEPENDENCIA">ANÁLISE PENDÊNCIA</option>
                                                    <option value="CANCELADO">CANCELADO</option>
                                                    <option value="DEFERIDO">DEFERIDO</option>
                                                    <option value="INDEFERIDO">INDEFERIDO</option>
                                                    <option value="EXIGENCIA">EXIGÊNCIA</option>
                                                    <option value="FALECEU">FALECEU</option>
                                                    <option value="RECURSO">RECURSO</option>
                                                    <option value="OUTROS">OUTROS</option>
                                                </select>

                                            </div>

                                            <div class="col-xl-2 col-md-6 mb-4">
                                                <small id="passwordHelpBlock" class="form-text text-muted">Nova
                                                    Entrada</small>
                                                <input class="form-control form-control-sm" name="novaentrada"
                                                       value=""></input>
                                            </div>

                                            <div class="col-xl-2 col-md-6 mb-4">
                                                <small id="passwordHelpBlock" class="form-text text-muted">Data
                                                    Pesquisa</small>
                                                <input class="form-control form-control-sm" name="datapesquisa"
                                                       value=""></input>
                                            </div>


                                            <div class="col-xl-2 col-md-6 mb-4">
                                                <small id="passwordHelpBlock" class="form-text text-muted">Advogado que
                                                    Assinou</small>
                                                <select class="form-control form-control-sm" name="advogadoqueassinou">
                                                    <option value=""></option>
                                                    <option value="Advogado">Advogado</option>

                                                </select>

                                            </div>

                                            <div class="col-xl-2 col-md-6 mb-4">
                                                <small id="passwordHelpBlock"
                                                       class="form-text text-muted">Pagamento</small>
                                                <input class="form-control form-control-sm" name="pagamento"
                                                       value=""></input>
                                            </div>

                                            <div class="col-xl-4 col-md-6 mb-4">
                                                <small id="passwordHelpBlock"
                                                       class="form-text text-muted">E-mail</small>
                                                <input style="text-transform: lowercase;" type="text"
                                                       class="form-control form-control-sm" name="email"
                                                       value=""></input>
                                            </div>

                                            <div class="col-xl-8 col-md-6 mb-4">
                                                <small id="passwordHelpBlock" class="form-text text-muted">Avaliação /
                                                    Perícia</small>
                                                <input class="form-control form-control-sm" name="avaliacaopericia"
                                                       value=""></input>
                                            </div>

                                        </div>


                                        <div class="form-row">
                                            <div class="col-xl-12 col-md-6 mb-4">
                                                <small id="passwordHelpBlock" class="form-text text-muted">-</small>
                                                <button type="submit" class="btn btn-success btn-block">Cadastrar
                                                </button>
                                            </div>
                                        </div>


                                    </div>


                                </div>
                    </form>

                </div>
                <div class="col-xl-3 col-md-6 mb-4">

                    <div class="card shadow mb-4">
                        <div class="card-body">


                            <div>
                            </div>
                        </div>
                    </div>

                </div>
            </div>
        </div>
        <!-- /.container-fluid -->
    </div>
    <!-- End of Main Content -->
    <!-- Footer -->
    <footer>
        <div class="container my-auto">


            <div class="copyright text-center my-auto">


                <div class="row">

                    <!-- Earnings (Monthly) Card Example -->
                    <div class="col-xl-6 col-md-6 mb-4">
                        <input type="button" value="Voltar" onClick="history.go(-1)" class="btn btn-Light btn-block"/>
                    </div>
                    <div class="col-xl-6 col-md-6 mb-4">
                        <input type="button" value="Avançar" onClick="history.go(+1)" class="btn btn-Light btn-block"/>
                    </div>


                </div>
            </div>
    </footer>


</div>
<!-- End of Content Wrapper -->
</div>

<script type="text/javascript">
    const map = L.map('map').setView([-22.9518079, -43.1931475], 15);

    L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
        attribution: '&copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors'
    }).addTo(map);


    L.marker([-22.951242450000002, -43.18967957753023]).addTo(map)
        .bindPopup('Rua Dona Mariana, 48 - Botafogo/RJ - Brasil')
        .openPopup();


    // se estÃ¡ clicado
    let isFetching = false


    map.on("click", async e => {

// para evitar muitos cliques
        if (isFetching) return

        isFetching = true

        const {lat, lng} = e.latlng

        const link = `https://nominatim.openstreetmap.org/reverse?lat=${lat}&lon=${lng}&addressdetails=1&format=jsonv2&`

        const data = await fetch(link)
            .then(response => response.json())
            .catch(error => false)
        console.log(data)

        document.querySelector("[name='logradouro']").value = `${data.address.road}`;
        document.querySelector("[name='numero']").value = `${data.address.house_number}`;
        document.querySelector("[name='bairro']").value = `${data.address.suburb}`;
        document.querySelector("[name='cidade']").value = `${data.address.city === undefined ? data.address.municipality : data.address.city}`;
        document.querySelector("[name='cep']").value = `${data.address.postcode}`;
        document.querySelector("[name='latitude']").value = `${data.lat}`;
        document.querySelector("[name='longitude']").value = `${data.lon}`;

        setTimeout(() => isFetching = false, 1500)
    })
</script>
<!-- End of Page Wrapper -->

<% include('../../partials/logoutmodal.ejs'); %>

<%- include('../../partials/footer.ejs'); %>